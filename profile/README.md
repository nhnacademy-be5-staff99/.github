![header](https://capsule-render.vercel.app/api?type=waving&height=250&color=DBD5D1&text=Store99st&fontAlignY=32&desc=from%20CNU-NHN%20Academy&descAlignY=50)

# ğŸ“– ì˜¨ë¼ì¸ ì„œì , Store99st
**ë°°í¬ url :** https://store99st.shop, https://www.store99st.shop

**Github :** https://github.com/nhnacademy-be5-staff99

**ê°œë°œ ê¸°ê°„ :** 2024.03.01 - 2024.05.22

**ì»¨ë²¤ì…˜ :** [convention.md](https://github.com/nhnacademy-be5-staff99/.github/blob/main/convention.md)

<br>

# Members

|<img src="https://avatars.githubusercontent.com/u/19241369?v=4" width= 80>|<img src="https://avatars.githubusercontent.com/u/86106442?v=4" width = 80>|<img src="https://avatars.githubusercontent.com/u/114563915?v=4" width = 80>|<img src="https://avatars.githubusercontent.com/u/138862600?v=4" width = 80>|<img src="https://avatars.githubusercontent.com/u/134525851?v=4" width = 80>|<img src="https://avatars.githubusercontent.com/u/148544516?v=4" width=80>|
|:---:|:---:|:---:|:---:|:---:|:---:|
|[ê¹€ìŠ¹ê·œ](https://github.com/seung-gyu-kim)|[ë…¸ë™ì˜](https://github.com/yrrho2)|[ì†¡ì•„í˜„](https://github.com/SongAhyeon01)|[ì†¡ì§„ê·œ](https://github.com/Rosin23)|[ì´ì„œì—°](https://github.com/SeoYeonLee12)|[ì§„íš¨ê²¸](https://github.com/jinhyogyeom)|
| ê²Œì´íŠ¸ì›¨ì´/ìœ ë ˆì¹´ | ë¡œê·¸ | ì¸ì¦/ë¡œê·¸ì¸ | íƒœê·¸ | ì¢‹ì•„ìš” | íšŒì› ê°€ì… |
| ì¹´í…Œê³ ë¦¬ | ë„ì„œ | ë§ˆì´í˜ì´ì§€ | í¬ì¸íŠ¸ | ë¦¬ë·° | ê²€ìƒ‰ |
| ì¥ë°”êµ¬ë‹ˆ | | ê²€ìƒ‰ ||||
| ì£¼ë¬¸/ê²°ì œ | | ì¿ í° ||||
| [ì„¸ë¶€ ì—…ë¬´](#%EA%B9%80%EC%8A%B9%EA%B7%9C) | [ì„¸ë¶€ ì—…ë¬´](#%EB%85%B8%EB%8F%99%EC%98%81) | [ì„¸ë¶€ ì—…ë¬´](#%EC%86%A1%EC%95%84%ED%98%84) | [ì„¸ë¶€ ì—…ë¬´](#%EC%86%A1%EC%A7%84%EA%B7%9C) | [ì„¸ë¶€ ì—…ë¬´](#%EC%9D%B4%EC%84%9C%EC%97%B0) | [ì„¸ë¶€ ì—…ë¬´](#%EC%A7%84%ED%9A%A8%EA%B2%B8) |

<br>

# ğŸŒ Development Environment
### ê°œë°œ ë„êµ¬
![intellijidea](https://img.shields.io/badge/Intellij-000000?style=for-the-badge&logo=intellijidea&logoColor=white)

### ê°œë°œ ì–¸ì–´
![Java](https://img.shields.io/badge/Java%2011-ED8B00?style=for-the-badge&logo=openjdk&logoColor=white)

### ë¹Œë“œ ë„êµ¬
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/134525851/46dd7801-40a8-4161-8ecd-ac04bb56ccb7)

### ê°œë°œ
![Spring](https://img.shields.io/badge/Spring-6DB33F?style=for-the-badge&logo=spring&logoColor=white) ![SpringBoot](https://img.shields.io/badge/Spring%20Boot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white) ![SpringSecurity](https://img.shields.io/badge/Spring%20Security-6DB33F?style=for-the-badge&logo=springsecurity&logoColor=white) ![SpringCloud](https://camo.githubusercontent.com/50acff628faae8cd4a63534f928755f865997bfee8c9949760f845ae410adf42/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f737072696e6720636c6f75642d3644423333463f7374796c653d666f722d7468652d6261646765266c6f676f3d737072696e67266c6f676f436f6c6f723d7768697465) 
![Spring Cloud Netflix](https://camo.githubusercontent.com/b6aea98627db04aa6fac0fd0d0c7980001b408e6233a8ce0b544875224e0ef52/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f737072696e6720657572656b612d3644423333463f7374796c653d666f722d7468652d6261646765266c6f676f3d737072696e67266c6f676f436f6c6f723d7768697465) ![Spring Cloud Gateway](https://github.com/nhnacademy-be5-staff99/.github/assets/134525851/bf0afbfc-52bd-4740-a228-64bc23f38a96) ![JPA](https://camo.githubusercontent.com/ad89845598b64900527549a5733ea06f7d687b837660cc1a19cf3936b6a137f6/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f737072696e672044617461204a50412d3644423333463f7374796c653d666f722d7468652d6261646765266c6f676f3d737072696e67266c6f676f436f6c6f723d7768697465) ![RestDocs](https://camo.githubusercontent.com/452f67ab6a315f728dc0df6fa9fa52da768616b1d85404da7cbda1b89912e340/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f737072696e672052455354646f63732d3644423333463f7374796c653d666f722d7468652d6261646765266c6f676f3d737072696e67266c6f676f436f6c6f723d7768697465)

### í…ŒìŠ¤íŠ¸
![SonarQube](https://camo.githubusercontent.com/1d11326da30b682f9d477137beab882521d0f5652cf868944da864e2706d026a/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f736f6e6172717562652d3445394243443f7374796c653d666f722d7468652d6261646765266c6f676f3d536f6e617251756265266c6f676f436f6c6f723d7768697465) ![image](https://github.com/nhnacademy-be5-staff99/.github/assets/134525851/08919490-0ae8-4772-9b7a-cf60c9317f01)

### DB
![Mysql](https://img.shields.io/badge/Mysql-4479A1?style=for-the-badge&logo=mysql&logoColor=white) ![Redis](https://img.shields.io/badge/Redis-DC382D?style=for-the-badge&logo=redis&logoColor=white)

### ê²€ìƒ‰ì—”ì§„
![ElasticSearch](https://camo.githubusercontent.com/88a4634ac0ccc183ed33b315478f53c202b6cfea2f91f92b1a50f8b5a2c78951/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f456c61737469635f5365617263682d3030353537313f7374796c653d666f722d7468652d6261646765266c6f676f3d656c6173746963736561726368266c6f676f436f6c6f723d7768697465)

### Cloud
![NHN Cloud](https://img.shields.io/badge/NHN%20Cloud-153887?style=for-the-badge&logo=iCloud&logoColor=white)

### Message Queue
![RabbitMQ](https://img.shields.io/badge/rabbitmq-%23FF6600.svg?&style=for-the-badge&logo=rabbitmq&logoColor=white)

### í˜‘ì—…ë„êµ¬
![GithubProject](https://camo.githubusercontent.com/fd499f0e176b319238be1f69a8baf80399cfbf5c4d3bc9e4717ca4c83960bb31/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4769746875622d3138313731373f7374796c653d666f722d7468652d6261646765266c6f676f3d676974687562266c6f676f436f6c6f723d7768697465)

### ECT
![Gmail](https://img.shields.io/badge/Gmail-EA4335?style=for-the-badge&logo=gmail&logoColor=white) ![kakao](https://img.shields.io/badge/Kakao-FFCD00?style=for-the-badge&logo=kakao&logoColor=black) ![JWT](https://camo.githubusercontent.com/138db798f7f1539dfa9daf51b867e320ca9fe0381dc64660974761449290c79a/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4a57542d3030303030303f7374796c653d666f722d7468652d6261646765266c6f676f3d6a736f6e776562746f6b656e73266c6f676f436f6c6f723d7768697465)

### CI/CD
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/134525851/c4b7f34e-ea51-4199-966a-550bf71f6d45) ![Jenkins](https://img.shields.io/badge/Jenkins-D24939?style=for-the-badge&logo=Jenkins&logoColor=white)

### UI
![Bootstrap](https://img.shields.io/badge/Bootstrap-563D7C?style=for-the-badge&logo=bootstrap&logoColor=white)

### Front
![Thymleaf](https://camo.githubusercontent.com/e1ad5eb422f04c6da31adacb553ce03975081d0987e58cec5ad00be07272bf54/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f7468796d656c6561662d3030354630463f7374796c653d666f722d7468652d6261646765266c6f676f3d7468796d656c656166266c6f676f436f6c6f723d7768697465) ![HTML](https://camo.githubusercontent.com/d30449fa2dbae519940a0d08f0202996163310b8c6b9336480232cfb48d38286/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f68746d6c352d4533344632363f7374796c653d666f722d7468652d6261646765266c6f676f3d68746d6c35266c6f676f436f6c6f723d7768697465) ![CSS](https://github.com/nhnacademy-be5-staff99/.github/assets/134525851/9aa807e7-95d3-4691-91e5-5dc77f515784) ![image](https://github.com/nhnacademy-be5-staff99/.github/assets/134525851/420f9542-cd7c-4e9c-a405-4d1f0d4f0277)

### Logging
![NHN Cloud Log & Crash Search](https://img.shields.io/badge/NHN%20Cloud%20Log%20&%20Crash%20Search-153887?style=for-the-badge&logo=iCloud&logoColor=white)


# ğŸ—ï¸ Project Architecture
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/19241369/c91f5a9b-06e1-4e60-ae4e-922b62e518dc)

# ğŸš€ CI/CD
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/19241369/fb136326-fc08-4d13-ac7a-1bb282e700da)

# ğŸ’¿ ERD
![STORE99 V1 6](https://github.com/nhnacademy-be5-staff99/.github/assets/114563915/75dd00a7-227e-494e-902f-db47aef8746a)


# ğŸ¤– Project Management
> Githubì˜ ê¸°ëŠ¥ `Projects`ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œì íŠ¸ ê´€ë¦¬

### [WBS](https://github.com/orgs/nhnacademy-be5-staff99/projects/1/views/1)
Github Project ë¡œ ê° ì‘ì—…ë§ˆë‹¤ ì´ìŠˆë¡œ ë“±ë¡í•˜ì—¬ ê´€ë¦¬
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/114563915/86015f30-869f-4652-88b4-a781ab41aa64)


### [Roadmap - ì¼ì •ê´€ë¦¬](https://github.com/orgs/nhnacademy-be5-staff99/projects/1/views/6)
Github Project ì˜ Roadmap ì„ ì´ìš©í•œ ë©¤ë²„ë³„ ì¼ì • ê´€ë¦¬
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/114563915/9773dc2c-c6bf-4e76-8d65-a936c49c2cb1)


### [Board - ì‘ì—… ê´€ë¦¬](https://github.com/orgs/nhnacademy-be5-staff99/projects/1/views/3)

Github Project ì˜ Board ì„ ì´ìš©í•œ ë©¤ë²„ë³„ ì‘ì—… ê´€ë¦¬
- Todo, InProgress, CodeReview, Delay, Done ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ìƒíƒœ í™•ì¸
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/114563915/9caeed8c-b0e3-4ec9-9f94-5e3383db2516)


### [Scrum](https://github.com/orgs/nhnacademy-be5-staff99/projects/1/views/7)
Scrum ì„ Github Issue ë¡œ ê´€ë¦¬
- ì£¼ë§ˆë‹¤ Scrum Masterë¥¼ ë³€ê²½í•˜ê³  íˆ¬í‘œë¥¼ í†µí•´ ë§ˆì§€ë§‰ 2ì£¼ì˜ Scrum Masterë¥¼ ê³ ì •
- ë§¤ì¼ 09ì‹œì— ìŠ¤í¬ëŸ¼ì„ ì§„í–‰. íŠ¹ì´ì‚¬í•­ ë°œìƒì‹œ Scrum Masterë¥¼ í†µí•˜ì—¬ ì¼ì • ë³€ê²½
- íŒ€ì›ê°„ ì§„í–‰ì‚¬í•­ê³¼ ê·¸ ë‚ ì˜ Taskë¥¼ ì •ë¦¬í•˜ê³  íŠ¹ì´ì‚¬í•­ì„ ê³µìœ í•¨ìœ¼ë¡œì¨ íŒ€ì›ê°„ í˜‘ë ¥ì ì´ê³  ì²´ê³„ì ì¸ í”„ë¡œì íŠ¸ ì§„í–‰
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/114563915/1f59922a-2bd8-4e2b-bfd0-0f9c413e3937)

### ì´ìŠˆ ê´€ë¦¬
- ì—ëŸ¬ë‚˜ ë²„ê·¸ ë“± ì´ìŠˆ ë°œìƒ ì‹œ Github Issue ë¡œ ë“±ë¡í•˜ì—¬ Github Projectsì—ì„œ ê´€ë¦¬
- ë‹¤ë¥¸ íŒ€ì›ì˜ ì´ìŠˆ ë°œê²¬ì‹œ Github Issue ìƒì„± í›„ Assigneesì— ë“±ë¡í•˜ì—¬ ê±´ì˜
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/86106442/b6562dba-faa7-4813-9829-4e846ae6150b)
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/86106442/a53f41bc-89b1-47c5-b643-eeae8275725a)

### Code Review
- ê°ê°ì˜ íŒ€ì›ì€ ë‹¤ë¥¸ 2ëª…ì˜ Pull Request ì½”ë“œë¦¬ë·°ë¥¼ ì»¨ë²¤ì…˜ ê·œì¹™ì— ë”°ë¼ ì„±ì‹¤íˆ ìˆ˜í–‰ [ì»¨ë²¤ì…˜: ì½”ë“œë¦¬ë·° ê·œì¹™](https://github.com/nhnacademy-be5-staff99/.github/blob/main/convention.md#%EC%BD%94%EB%93%9C%EB%A6%AC%EB%B7%B0)
- Pull Requestì˜ ìˆ˜ì •ì‚¬í•­ê³¼ ê´€ë ¨ëœ íŒ€ì›ì€ ì„ì˜ë¡œ ë¦¬ë·°ì–´ì— ì¶”ê°€, ë³€ê²½ ë  ìˆ˜ ìˆìŒ
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/86106442/e01df437-bf73-4a89-9f6e-823541322ff2)

### [ê¸°ìˆ  ê³µìœ ](https://github.com/orgs/nhnacademy-be5-staff99/projects/1/views/12)
íŒ€ì›ê°„ì˜ í˜‘ì—…ê³¼ ê°œë°œì˜ íš¨ìœ¨ì„ ìƒìŠ¹ì‹œí‚¤ê¸° ìœ„í•´ ê°ì í•™ìŠµí•œ ê¸°ìˆ ì„ WBS Issueë¡œ ë“±ë¡, ì‘ì„±í•˜ì—¬ ê³µìœ 
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/86106442/bc528076-ef31-4f81-a5dd-427feca8d7ba)

# ğŸ§ª Test
## Test Coverage
### bookstore í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/138862600/aba1fa7d-a9c1-41ba-b5ca-6faea7eb0ca6)

## Black Box Test
- ë§¤ ì£¼ ê°œë°œë‚´ìš©ì„ ë°°í¬ ì‹œ í˜ì´ì§€ì˜ ëª¨ë“  ë™ì‘ì„ ê²€ì‚¬
- ê¸°ì¡´ ê¸°ëŠ¥ê³¼ ìƒˆë¡œ ë°°í¬ë˜ëŠ” ê¸°ëŠ¥ì„ ì¤‘ì ì ìœ¼ë¡œ ì‚¬ì´ë“œ ì´í™íŠ¸ ìœ ë¬´ íŒŒì•…

### Black box test flow
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/86106442/5f1e3a32-51f2-4df5-a6d4-259898f4c3bc)

### [í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸](https://github.com/orgs/nhnacademy-be5-staff99/projects/1/views/13)
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/86106442/bf307fd8-c4bc-4b60-a066-9e306d7620be)

## White Box Test(Unit Test)
### Controller Test
RestDocSupportì™€ @WebMvcTestë¥¼ í™œìš©í•˜ì—¬ Controller ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ êµ¬í˜„

#### RestDocSupport.java
Spring REST Docsì„ ìœ„í•œ ê¸°ëŠ¥ê³¼ ê´€ë¦¬ì ê¶Œí•œì„ ë°˜í™˜í•˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ Mockingí•˜ëŠ” ê¸°ëŠ¥ì´ ë“¤ì–´ìˆëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸ ì§€ì›ì„ ìœ„í•œ í´ë˜ìŠ¤
```java
/**
 * Rest docsë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ Support í´ë˜ìŠ¤
 * @author seunggyu-kim 
 */
@Disabled
@Import(RestDocsConfig.class)
@ExtendWith({RestDocumentationExtension.class})
public abstract class RestDocSupport {
    @Autowired
    protected MockMvc mockMvc;

    @Autowired
    protected ObjectMapper objectMapper;

    @Autowired
    protected RestDocumentationResultHandler restDoc;

    // ê´€ë¦¬ì ì—¬ë¶€ í…ŒìŠ¤íŠ¸ ìš©ìœ¼ë¡œ ì‚¬ìš©
    // ex) BDDMockito.given(adminCheckService.isAdmin(Mockito.anyLong())).willReturn(true);
    @MockBean
    protected AdminCheckService adminCheckService;

    /**
     * Spring Rest Docsë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì„¤ì •
     *
     * @param webApplicationContext
     * @param restDocumentationContextProvider
     */
    @BeforeEach
    public void setup(
            final WebApplicationContext webApplicationContext,
            final RestDocumentationContextProvider restDocumentationContextProvider
    ) {
        this.mockMvc = MockMvcBuilders.webAppContextSetup(webApplicationContext)
                .apply(MockMvcRestDocumentation.documentationConfiguration(restDocumentationContextProvider))
                .alwaysDo(MockMvcResultHandlers.print())
                .alwaysDo(restDoc)
                .addFilters(new CharacterEncodingFilter("UTF-8", true))     // í•œê¸€ ê¹¨ì§ ë°©ì§€ ì²˜ë¦¬
                .build();
    }
}
```
#### ì»¨íŠ¸ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ(AdminCheckControllerTest.java)
given, when, thenìœ¼ë¡œ ë‚˜ëˆ„ì–´ BDD ë°©ì‹ìœ¼ë¡œ êµ¬í˜„
```java
@WebMvcTest(AdminCheckController.class)
class AdminCheckControllerTest extends RestDocSupport {
    /**
     * ê´€ë¦¬ì ì—¬ë¶€ í™•ì¸ í…ŒìŠ¤íŠ¸
     * <p>ì‚¬ìš©ìê°€ ê´€ë¦¬ì ê¶Œí•œì„ ê°–ê³ ìˆëŠ” ê²½ìš°
     *
     * @throws Exception
     */
    @DisplayName("ê´€ë¦¬ì ì—¬ë¶€ í™•ì¸ - ê´€ë¦¬ìì¸ ê²½ìš°")
    @Test
    void checkAdmin_true() throws Exception {
        // given
        Long userId = Mockito.anyLong();
        BDDMockito.given(adminCheckService.isAdmin(userId)).willReturn(true);

        // when
        String response = mockMvc.perform(
                        MockMvcRequestBuilders.get("/v1/admin/check")
                                .header("X-USER-ID", userId))
                .andExpectAll(
                        MockMvcResultMatchers.status().isOk()
                )
                .andReturn().getResponse().getContentAsString();

        // then
        CommonHeader commonHeader = CommonHeader.builder().httpStatus(HttpStatus.OK).resultMessage("Success").build();
        CommonResponse<AdminCheckResponse> commonResponse =
                CommonResponse.<AdminCheckResponse>builder().header(commonHeader).result(new AdminCheckResponse(true))
                        .build();
        String expected = objectMapper.writeValueAsString(commonResponse);
        Assertions.assertThat(response).isEqualTo(expected);
    }
    ...(ìƒëµ)
}
```

### Service Test
@ExtendWith(MockitoExtension.class)ë¥¼ í™œìš©í•˜ì—¬ Service ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ êµ¬í˜„
- given, when, thenìœ¼ë¡œ ë‚˜ëˆ„ì–´ BDD ë°©ì‹ìœ¼ë¡œ êµ¬í˜„
- MockedStaticì„ ì´ìš©í•˜ì—¬ XUserIdThreadLocalì— ì €ì¥ëœ xUserId ë³€ê²½
```java
@ExtendWith(MockitoExtension.class)
class CartServiceImplTest {
    @InjectMocks
    private CartServiceImpl cartService;
    @Mock
    private CartRepository cartRepository;
    @Mock
    private UserRepository userRepository;
    @Mock
    private BookRepository bookRepository;

    ...(ìƒëµ)...

    @Test
    @DisplayName("ì¥ë°”êµ¬ë‹ˆì— ì±… ì¶”ê°€ - ì±…ì´ ì—†ì„ ê²½ìš°")
    void addBookToCartWhenBookNotFound() {
        try (MockedStatic<XUserIdThreadLocal> utilities = mockStatic(XUserIdThreadLocal.class)) {
            // given
            CartItemRequest request = new CartItemRequest(1L, 1);
            given(XUserIdThreadLocal.getXUserId()).willReturn(1L);
            given(cartRepository.findByUser_IdAndBook_Id(1L, 1L)).willReturn(Optional.empty());
            given(userRepository.findById(1L)).willReturn(Optional.of(User.builder().id(1L).build()));
            given(bookRepository.findById(1L)).willReturn(Optional.empty());

            // when & then
            assertThatThrownBy(() -> cartService.addBookToCart(request))
                    .isInstanceOf(CartBadRequestException.class)
                    .hasMessageContaining("Book not found (book id: 1)");
            verify(cartRepository, never()).save(Mockito.any(Cart.class));
        }
    }
}
```

### Repository Test
@DataJpaTestë¥¼ í™œìš©í•˜ì—¬ Repository ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ êµ¬í˜„
- given, when, thenìœ¼ë¡œ ë‚˜ëˆ„ì–´ BDDë°©ì‹ìœ¼ë¡œ í…ŒìŠ¤íŠ¸

```java
@DataJpaTest
class CartRepositoryImplTest {
    @Autowired
    private TestEntityManager entityManager;

    @Autowired
    private CartRepository cartRepository;

    ...(ìƒëµ)...

    @Test
    @DisplayName("ì‚¬ìš©ì IDë¡œ ì¥ë°”êµ¬ë‹ˆ ì•„ì´í…œ ì¡°íšŒ")
    void getCartItemsByUser() {
        // given
        Cart cart1 = Cart.builder()
                .cartAmount(1)
                .user(user)
                .book(book1)
                .build();
        entityManager.persist(cart1);

        Cart cart2 = Cart.builder()
                .cartAmount(2)
                .user(user)
                .book(book2)
                .build();
        entityManager.persist(cart2);

        // when
        List<CartItemResponse> cartItemResponses = cartRepository.getCartItemsByUser(user.getId());

        // then
        List<CartItemResponse> expectedCartItemResponses = new ArrayList<>();
        CartItemResponse expectedCartItemResponse1 = new CartItemResponse(
                book1.getId(),
                book1.getBookTitle(),
                book1.getBookPrice(),
                book1.getBookSalePrice(),
                book1.getBookThumbnailUrl(),
                book1.getBookStock(),
                cart1.getCartAmount()
        );
        expectedCartItemResponses.add(expectedCartItemResponse1);
        CartItemResponse expectedCartItemResponse2 = new CartItemResponse(
                book2.getId(),
                book2.getBookTitle(),
                book2.getBookPrice(),
                book2.getBookSalePrice(),
                book2.getBookThumbnailUrl(),
                book2.getBookStock(),
                cart2.getCartAmount()
        );
        expectedCartItemResponses.add(expectedCartItemResponse2);

        assertThat(cartItemResponses).usingRecursiveComparison().isEqualTo(expectedCartItemResponses);
    }
}
```


# ğŸ–ï¸ Member Role
## ê³µí†µ
![image](https://github.com/nhnacademy-be5-staff99/.github/assets/138862600/7cd05dca-f174-43df-b32e-ae21cce5a715)

## ê¹€ìŠ¹ê·œ
### ê²Œì´íŠ¸ì›¨ì´/ìœ ë ˆì¹´
- openìœ¼ë¡œ ì‹œì‘í•˜ëŠ” urlì˜ apiëŠ” openì„ ë¶™ì—¬ì„œ ì„œë²„ë¡œ ë³´ë‚´ê³ , ê·¸ ì™¸ urlì˜ apiëŠ” prefixë¥¼ ì œê±°í•˜ì—¬ ë³´ë‚¸ë‹¤.
  - ì´ë ‡ê²Œ í•  ê²½ìš°, í”„ë¡ íŠ¸ì™€ ë°± ì„œë²„ì—ì„œ urlì˜ /open ì—¬ë¶€ë¡œ í† í° ë° ì¸ì¦ì— ê´€ë ¨ëœ ê³µí†µ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤.
- [API ëª…ì„¸](https://github.com/nhnacademy-be5-staff99/.github/blob/main/convention.md#api)
  - api/bookstore/v1/â€¦
  - api/coupon/v1/â€¦
  - open/bookstore/v1/â€¦
  - open/coupon/v1/â€¦
  - open
    - Front -> Gateway
      - url: /open/bookstore/v1/â€¦
    - Gateway -> Bookstore
      - url: /v1/â€¦
  - api
    - Front -> Gateway
      - url: /api/bookstore/v1/â€¦
      - Hearder: X-USER-TOKEN : jwt token
    - Gateway -> Bookstore
      - url: /v1/â€¦
      - Header: X-USER-ID : Long userId
     
### ê³µí†µì²˜ë¦¬
- bookstore ì„œë²„ì—ì„œ /openìœ¼ë¡œ ì‹œì‘í•˜ì§€ ì•ŠëŠ” urlì˜ ê²½ìš° xUserId headerì˜ ê°’ì„ ì“°ë ˆë“œ ë¡œì»¬ì— ì €ì¥í•˜ëŠ” ì¸í„°ì…‰í„° ì²˜ë¦¬
- bookstore ì„œë²„ì—ì„œ /adminìœ¼ë¡œ ì‹œì‘í•˜ëŠ” urlì˜ ê²½ìš° admin ê¶Œí•œ ê²€ì‚¬í•˜ëŠ” ì¸í„°ì…‰í„° ì²˜ë¦¬
- front ì„œë²„ì—ì„œ ê´€ë¦¬ì ê¶Œí•œì„ ê²€ì‚¬ê°€ í•„ìš”í•œ ë©”ì†Œë“œ ìœ„ì— @AdminPermissionCheckë¥¼ ë‹¬ì•„ì„œ ê´€ë¦¬ì ê²€ì‚¬ AOP ì²˜ë¦¬
- ì»¨ë²¤ì…˜ì— ì •í•´ì§„ ê³µí†µ ì‘ë‹µê°ì²´ í˜•ì‹ ê´€ë ¨ ResponseBodyAdvice ì²˜ë¦¬
  ```json
  {
    "header": {
        "isSuccessful":true,
        "resultCode":200,
        "resultMessage":"Success"
    },
    "result": {
        ...
    }
  }
  ```

### ì¹´í…Œê³ ë¦¬
- ê´€ë¼ì§€ ê¶Œí•œì˜ ìœ ì €ì¼ ê²½ìš° ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ì¹´í…Œê³ ë¦¬ ì¶”ê°€, ìˆ˜ì •, ì‚­ì œ ê°€ëŠ¥
- ìŠ¤í† ì–´ì—ì„œ ìƒìœ„ ì¹´í…Œê³ ë¦¬ì—ì„œ í•˜ìœ„ ì¹´í…Œê³ ë¦¬ë¡œ ê²€ìƒ‰ ê°€ëŠ¥

### ì¥ë°”êµ¬ë‹ˆ
- ì¥ë°”êµ¬ë‹ˆ í˜ì´ì§€ ë‚´ì—ì„œ ìˆ˜ëŸ‰ ì¡°ì ˆ ë° ì‚­ì œ ê°€ëŠ¥
- ë¹„íšŒì›
  - ë ˆë””ìŠ¤ì˜ í‚¤ë¥¼ ì¿ í‚¤ë¡œ ì €ì¥í•˜ê³  ë ˆë””ìŠ¤ì— ë„ì„œ ì•„ì´ë””ì™€ ìˆ˜ëŸ‰ì„ ì €ì¥
- íšŒì›
  - DB ì¥ë°”êµ¬ë‹ˆ í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬ ë°ì´í„° ì¡°íšŒ
- ì¥ë°”êµ¬ë‹ˆì— ë„ì„œê°€ ë“¤ì–´ê°€ ìˆëŠ” ìƒíƒœì—ì„œ ë¡œê·¸ì¸ì„ í•˜ë©´ ë¹„íšŒì›ì˜ ì¥ë°”êµ¬ë‹ˆ ë‚´ìš©ì´ íšŒì›ì— ì¶”ê°€ë˜ê³  ë¹„íšŒì› ì¥ë°”êµ¬ë‹ˆ ì‚­ì œ

### ì£¼ë¬¸/ê²°ì œ(ì§„í–‰ì¤‘)
- ì£¼ë¬¸ í™”ë©´ìœ¼ë¡œ ì´ë™í•  ë•Œì™€, ê²°ì œ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ë„ì„œ ì¬ê³  í™•ì¸
- ì£¼ë¬¸ í™”ë©´ì—ì„œ ì¹´ì¹´ì˜¤ ë„ë¡œëª… ì£¼ì†Œë¡œ ì£¼ì†Œ ì…ë ¥ ê°€ëŠ¥
- íšŒì› ì£¼ë¬¸ì˜ ê²½ìš° í¬ì¸íŠ¸, ì¿ í° ì‚¬ìš© ê°€ëŠ¥
- ì£¼ë¬¸ í›„ íšŒì› ë“±ê¸‰ì— ë”°ë¼ í¬ì¸íŠ¸ ì ë¦½
- í† ìŠ¤ í˜ì´ë¨¼íŠ¸ë¡œ ê²°ì œ

### ê¸°íƒ€
- ì½”ë“œ ìŠ¤íƒ€ì¼ ì •ë¦½ / Git ì»¨ë²¤ì…˜ í†µì¼ / PR ë° íŒ€ ê·œì¹™ ì •ë¦½
  - [convention.md](https://github.com/nhnacademy-be5-staff99/.github/blob/main/convention.md)
- DBì™€ ë§¤í•‘ë˜ëŠ” ëª¨ë“  JPA ì—”í‹°í‹° í´ë˜ìŠ¤ ìƒì„±
  - @Setter ì‚¬ìš© ì•ˆí•¨
  - íƒ€ì…ê³¼ ê°™ì€ ê²½ìš°ëŠ” enum ì‚¬ìš©
  - joinì€ LAZYë¡œ
- Spring REST docs ì ìš©
  - Spring REST Docsì„ ìœ„í•œ ê¸°ëŠ¥ê³¼ ê´€ë¦¬ì ê¶Œí•œì„ ë°˜í™˜í•˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ Mockingí•˜ëŠ” ê¸°ëŠ¥ì´ ë“¤ì–´ìˆëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸ ì§€ì›ì„ ìœ„í•œ RestDocSupport í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸ ê³µí†µí™”

## ë…¸ë™ì˜
### Front Server ì´ì¤‘í™”, SSL ì„¤ì •
- íŒ€ Domainì˜ SSL ì¸ì¦ì„œë¥¼ NGINXì— ì ìš©í•˜ì—¬ HTTPSí†µì‹  í™œì„±í™”
- Front Serverë¥¼ NHN LoadBalancerì— ì—°ê²°í•˜ì—¬ ì´ì¤‘í™”
### Logging
- Repositoryì— NHN Cloud Log&Crashì„ ì ìš©í•˜ì—¬ í´ë¼ìš°ë“œì—ì„œ ì¸ìŠ¤í„´ìŠ¤ ë¡œê·¸ ê²€ìƒ‰ ê°€ëŠ¥
- í”„ë¡œì íŠ¸ì— ë¡œê¹… ì ìš© ì •ë¦¬ í›„ Github Projectsì— ê¸°ìˆ ê³µìœ  Issue ê³µìœ 
   - https://github.com/nhnacademy-be5-staff99/store99-ect/issues/16
### ë„ì„œ
- Query Dsl, Pageable, fetch join, DTO projection, Transformì„ ì‚¬ìš©í•œ ë„ì„œ ë°ì´í„° ì‚¬ìš©
- ì¹´í…Œê³ ë¦¬ê¸°ì¤€ìœ¼ë¡œ ë„ì„œ ê²€ìƒ‰
- ë„ì„œ ìƒì„¸í˜ì´ì§€ ì¡°íšŒ ê°€ëŠ¥
- ì¸ë±ìŠ¤ í˜ì´ì§€ì— ë² ìŠ¤íŠ¸, ì‹ ìƒ ë„ì„œ ì¶”ê°€ (ì§„í–‰ì¤‘)

## ì†¡ì•„í˜„
### ì¸ì¦/ì¸ê°€

**ì¸ì¦ ì„œë²„**
- Spring Security ì— Custom Filter ë¥¼ ë§Œë“¤ì–´ ë¡œê·¸ì¸ ì§„í–‰
- ë¡œê·¸ì¸ ì„±ê³µ ì‹œ Redis ì— userId ì €ì¥
- Redis Key ë¥¼ í¬í•¨í•œ JWT Token ë°œê¸‰í•˜ì—¬ header ë¡œ ì „ë‹¬
- ë¡œê·¸ì•„ì›ƒ ì‹œ Custom Logout Filter ë¥¼ ê±°ì³ ë¡œê·¸ì•„ì›ƒ ì§„í–‰ & Redis ì—ì„œ key ì‚­ì œ

**í”„ë¡ íŠ¸ ì„œë²„** 
- í´ë¼ì´ì–¸íŠ¸ì—ê²Œ Cookie ë¡œ JWT í† í° ì „ë‹¬
- ì´í›„ ë¡œê·¸ì¸ì´ í•„ìš”í•œ api ìš”ì²­ ì‹œ JWT í† í°ì„ í•¨ê»˜ ì „ë‹¬

**Gateway ì„œë²„**
- ë¡œê·¸ì¸ì´ í•„ìš”í•œ api ìš”ì²­ ì‹œ ì „ë‹¬ ë°›ì€ JWT í† í°ì˜ ë‚´ìš©ì„ í™•ì¸í•˜ì—¬ userId í™•ì¸
- í™•ì¸ëœ userId ë¥¼ bookstore ì„œë²„ì— headerë¡œ ì „ë‹¬
- (NHN Cloud ì˜ ë³´ì•ˆ ê·¸ë£¹ì„ ë‚´ë¶€ ip ë¡œ í•œì •í•˜ì—¬ ë‹¤ë¥¸ ip ì—ì„œ ì ‘ê·¼ ë¶ˆê°€í•¨)

### Login Sequence

```mermaid

sequenceDiagram

actor c as Client
participant front as Front
participant redis as Redis
participant gateway as Gateway
participant auth as Auth
participant store as BookStore

c->>front: 1. ë¡œê·¸ì¸ í˜ì´ì§€ ìš”ì²­
front-->>c: 2. ë¡œê·¸ì¸ í˜ì´ì§€ ì‘ë‹µ
c->>front: 3. Email, PW ì…ë ¥
front->>gateway: 4. ë¡œê·¸ì¸ ìš”ì²­
gateway->>auth: 4. ë¡œê·¸ì¸ ìš”ì²­
auth-->>gateway: 5. ë¡œê·¸ì¸ api í˜¸ì¶œ
gateway->>store: 5. ë¡œê·¸ì¸ api í˜¸ì¶œ
alt ë¡œê·¸ì¸ ì‹¤íŒ¨
	store-->>gateway: 6. íšŒì› ì •ë³´ ì—†ìŒ or ID/PW ë¶ˆì¼ì¹˜
	gateway->>auth: 6. íšŒì› ì •ë³´ ì—†ìŒ or ID/PW ë¶ˆì¼ì¹˜
	auth-->>gateway: 7. ë¡œê·¸ì¸ ì‹¤íŒ¨
	gateway-->>front: 7. ë¡œê·¸ì¸ ì‹¤íŒ¨
	front-->>c: 7. ë¡œê·¸ì¸ ì‹¤íŒ¨
else ë¡œê·¸ì¸ ì„±ê³µ
	store-->>gateway: 6. ë¡œê·¸ì¸ ì„±ê³µ & êµ¬ë§¤ì id ì „ë‹¬
	gateway->>auth: 6. ë¡œê·¸ì¸ ì„±ê³µ & êµ¬ë§¤ì id ì „ë‹¬
	auth-->>redis: 7. UUID ì €ì¥
    Note over auth: AccessToken ìƒì„±
    auth-->>gateway: 8. Header ì— AccessToken ë‹´ì•„ì„œ ì „ë‹¬
    gateway-->>front: 9. Headerì˜ Set-Cookie ì— Token ë‹´ì•„ì„œ ì „ë‹¬
    front-->>c: 9. ë¡œê·¸ì¸ ì„±ê³µ, ì¿ í‚¤ ì „ë‹¬
end

```

### Authorization Sequence

> ì˜ˆì‹œ : ë§ˆì´í˜ì´ì§€ ìš”ì²­

```mermaid

sequenceDiagram

actor c as Client
participant front as Front
participant redis as Redis
participant gateway as Gateway
participant auth as Auth
participant store as BookStore

c->>front: 1. ë§ˆì´í˜ì´ì§€ ìš”ì²­
front->>+gateway: 1. ë§ˆì´í˜ì´ì§€ ìš”ì²­
Note over gateway: í† í° ë§Œë£Œ ì—¬ë¶€ í™•ì¸
alt í† í° ë§Œë£Œ
    gateway-->>front: 2. ì¸ì¦ ì‹¤íŒ¨
    front-->>c: 3. ë¡œê·¸ì¸ í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸
else í† í° ì‚¬ìš© ê°€ëŠ¥
    gateway-->>redis: 2. UUID ë¡œ êµ¬ë§¤ì id ì¡°íšŒ
    redis->>gateway: 3. êµ¬ë§¤ì id ì „ë‹¬
    gateway->>store: 4. headerì— êµ¬ë§¤ì id ë‹´ì•„ ë§ˆì´í˜ì´ì§€ api í˜¸ì¶œ
    Note over store: êµ¬ë§¤ì id ë¡œ íšŒì› ê¶Œí•œ ì¡°íšŒ
    alt ê¶Œí•œ ì—†ìŒ
        store-->>gateway: 5. ìš”ì²­ ì‹¤íŒ¨ ì‘ë‹µ
        gateway-->>front: 5. ìš”ì²­ ì‹¤íŒ¨ ì‘ë‹µ
        front-->>c: 6. ë¡œê·¸ì¸ í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸
    
    else ê¶Œí•œ ìˆìŒ
        store-->>gateway: 5. íšŒì› ì •ë³´ ì „ë‹¬
        gateway-->>front: 5. íšŒì› ì •ë³´ ì „ë‹¬
        front-->>c: 6. ë§ˆì´í˜ì´ì§€ ì‘ë‹µ
    end
end

```

### ë§ˆì´í˜ì´ì§€
- íšŒì› ê¸°ë³¸ ì •ë³´, í˜„ì¬ ë“±ê¸‰, í˜„ì¬ ì‚¬ìš© ê°€ëŠ¥ í¬ì¸íŠ¸ í™•ì¸
- Daum ë„ë¡œëª… ì£¼ì†Œ API ë¥¼ ì´ìš©í•œ ì£¼ì†Œ ê´€ë¦¬
- í¬ì¸íŠ¸ ì ë¦½/ì‚¬ìš© ë‚´ì—­ í™•ì¸

### ë‹¨ìˆœ ê²€ìƒ‰
- Index ì˜ ê²€ìƒ‰ì°½ì— ì…ë ¥í•œ ê²€ìƒ‰ì–´ê°€ ë„ì„œëª…ì´ë‚˜ ì €ìëª…ì— í¬í•¨ëœ ë„ì„œ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜
- pagenation êµ¬í˜„

### ì¿ í° (ì§„í–‰ì¤‘)
- ìƒì¼ ì¿ í°, ì›°ì»´ ì¿ í°, ë„ì„œ ì¿ í°, ì¹´í…Œê³ ë¦¬ ì¿ í° ìƒì„±,ë°œê¸‰ api êµ¬í˜„
- ë§¤ì›” ìƒì¼ìì— ëŒ€í•´ ìƒì¼ ì¿ í° ë°œê¸‰
- Rabbit MQ ë¥¼ ì‚¬ìš©í•´ ëŒ€ê·œëª¨ íŠ¸ë˜í”½ ë°œìƒì— ëŒ€ë¹„ 

## ì†¡ì§„ê·œ
### íƒœê·¸
- íƒœê·¸ ìƒì„±, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œ êµ¬í˜„ ë° ê´€ë¦¬ì í™”ë©´ ì œì‘
- ì´ë¦„ ì¤‘ë³µ ì²˜ë¦¬ë¥¼ ìœ„í•´ AlreadyExistsException ì„ ë§Œë“¤ì–´ @ExceptionHandlerë¥¼ í†µí•´ ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬ ë° Response ê³µí†µí™”ì™€ 409 CONFLICT ë°˜í™˜
- íƒœê·¸ì´ë¦„ì„ í¬í•¨í•œ ê²€ìƒ‰
  
### í¬ì¸íŠ¸
- í¬ì¸íŠ¸ ì ë¦½ ì¤‘ ì´ì „ ì •ì±… ì¡°íšŒë¥¼ ìœ„í•´ soft delete ì ìš©
- ê´€ë¦¬ì í™”ë©´ì—ì„œ íšŒì›ì˜ í¬ì¸íŠ¸ ì ë¦½, ì°¨ê° ë‚´ì—­ ì¡°íšŒ
- í¬ì¸íŠ¸ ì •ì±… ì„¤ì •ì— ë”°ë¼ í¬ì¸íŠ¸ ì ë¦½
- ìˆœì£¼ë¬¸ê¸ˆì•¡ ì‚°ì • í›„ ê¸ˆì•¡ êµ¬ê°„ë³„ ë“±ê¸‰ ë° í¬ì¸íŠ¸ ì ë¦½ë¥  ì„¤ì •
- 3ê°œì›” ë§ˆë‹¤ 1íšŒ ë“±ê¸‰ ì—…ë°ì´íŠ¸

### ê¸°íƒ€
- ë„ì„œ ì‡¼í•‘ëª°ì— ì í•©í•œ UI/UXí™”ë©´ í…œí”Œë¦¿ ì ìš©
- Fragmentë¥¼ Layoutì— ë„£ì–´ ì¡°í•©í•  ìˆ˜ ìˆë„ë¡ Thymeleaf layout dialect ì ìš© 
- Aladin API, Naver API, crawlingì„ í†µí•œ ë„ì„œ, ì¹´í…Œê³ ë¦¬, ì €ì ë°ì´í„° ì‚½ì…

## ì´ì„œì—°
### ì¢‹ì•„ìš”
- ìƒí’ˆì˜ ì¢‹ì•„ìš” ë° ì·¨ì†Œ
- íšŒì›ìš© ì¢‹ì•„ìš”í•œ ìƒí’ˆ ìš”ì•½ ì¡°íšŒ
- ì¢‹ì•„ìš” ìˆ˜ ì¡°íšŒ
### ë¦¬ë·°(ì§„í–‰ ì¤‘)
- ì‚¬ì§„ ë¦¬ë·° ìƒì„±, ì¡°íšŒ, ìˆ˜ì •
- í…ìŠ¤íŠ¸ì™€ í‰ê°€ ì ìˆ˜ ë¦¬ë·° ìƒì„±, ì¡°íšŒ, ìˆ˜ì •
### ë¶ìŠ¤í† ì–´ ìºì‹œ ì ìš© (ì§„í–‰ì˜ˆì •)
- Simple Cache
- EHCache
- RedisCache
- 
## ì§„íš¨ê²¸
### íšŒì›
 - íšŒì›ê°€ì… ì‹œ goolge ì´ë©”ì¼ì¸ì¦ ì ìš©
 - Daum ë„ë¡œëª…ì£¼ì†Œ api ì´ìš©í•´ ì£¼ì†Œ ì •ë³´ ì…ë ¥
 - ì¤‘ë³µ ê°€ì…, íšŒì› íƒˆí‡´ì— ê´€í•œ ì´ë©”ì¼ ì¤‘ë³µ ì²˜ë¦¬
 - íšŒì›ê°€ì… ì‹œ í¬ì¸íŠ¸ ë‚´ì—­, ì£¼ì†Œ ì •ë³´ ìë™ ìƒì„±
 - ë§ˆì´í˜ì´ì§€ì—ì„œ íšŒì› íƒˆí‡´ ê¸°ëŠ¥(ì§„í–‰ì¤‘)
### ê²€ìƒ‰ (ì§„í–‰ì˜ˆì •)
 - elk ì„œë²„ êµ¬ì¶•
 - ë„ì„œ í†µí•© ê²€ìƒ‰
 - ë™ì˜ì–´, ìœ ì˜ì–´ ê²€ìƒ‰
